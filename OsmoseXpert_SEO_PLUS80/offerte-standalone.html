<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Offerte – OsmoseXpert</title>

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "OsmoseXpert",
    "url": "https://www.osmose-xpert.be",
    "logo": "https://www.osmose-xpert.be/images/brand/OsmoseXpert Logo voor Raamreining.png"
  }
  </script>

  <!-- Favicons -->
  <<link rel="icon" type="image/png" href="/images/favicons/favicon.png"/>
  <meta name="theme-color" content="#0A5FD1"/>

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="OsmoseXpert – Ramen &amp; zonnepanelen reinigen"/>
  <meta property="og:description" content="Streeploos resultaat met puur osmosewater. Veilig vanaf de grond, geen chemie, transparante prijzen. Boek meteen online."/>
  <meta property="og:url" content="https://www.osmose-xpert.be/"/>
  <meta property="og:image" content="https://www.osmose-xpert.be/images/social/logo4.jpg"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Offerte – OsmoseXpert"/>
  <meta name="twitter:description" content="Ontvang snel een transparante offerte voor ramen, glasgevels of zonnepanelen. Antwoord binnen 24 uur."/>
  <meta name="twitter:image" content="https://www.osmose-xpert.be/images/social/osmosexpert-og-1200x630.png"/>

  <!-- Meta description -->
  <meta name="description" content="Ontvang snel een transparante offerte voor ramen, glasgevels of zonnepanelen. Antwoord binnen 24 uur."/>

  <link rel="canonical" href="https://osmose-xpert.be/offerte-standalone.html"/>
  <meta name="robots" content="noindex, nofollow"/>

  <link rel="stylesheet" href="assets/css/cookie-banner.css"/>

  <style>
    /* Reset and variables */
    *{box-sizing:border-box;margin:0;padding:0}
    :root{--brand:#0f6ab8;--ink:#1e293b;--bg:#f6f9fc;--dark:#011a3a}
    body{font-family:Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.6}
    a{color:var(--brand);text-decoration:none;transition:all .2s ease}
    a:hover{text-decoration:underline}

    /* Utilities */
    .hidden{display:none !important}
    .subtle-note{font-size:13px;color:#5f7587;margin:6px 0 0}

    /* Topbar */
    .ox-topbar{position:sticky;top:0;z-index:100;background:#ffffff;border-bottom:1px solid #e2e8f0}
    .ox-topbar-inner{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:16px;padding:14px 20px}
    .ox-brand img{display:block;height:36px;width:auto}
    .ox-topbar .ox-call{margin-left:auto;display:inline-block;padding:8px 14px;border-radius:999px;border:1px solid #e6ecf0;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,.06);font-weight:600;color:#0b1423;text-decoration:none}
    @media (max-width:768px){
      .ox-topbar{background:#0f6ab8;border-bottom:none}
      .ox-topbar .ox-call{display:none}
    }

    /* Full-bleed compact banner with #f8f7f3 background */
    .ox-image-banner{
      background:linear-gradient(90deg, #efeeec 0%, #fafcfe 100%);
      width:100vw;
      margin-left:calc(50% - 50vw);
      margin-right:calc(50% - 50vw);
      padding:12px 0;
    }
    .ox-image-banner .inner{max-width:1200px;margin:0 auto;padding:0 16px}
    .ox-image-banner img{display:block;width:100%;height:160px;object-fit:contain}
    @media (min-width:1024px){ .ox-image-banner img{height:180px} }
    @media (max-width:768px){ .ox-image-banner img{height:130px} }

    /* Layout */
    .wrap{max-width:1100px;margin:28px auto;padding:0 20px}
    .intro{margin-bottom:8px;color:#334155;font-size:14px}
    .card{background:#fff;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,0.05);overflow:hidden}
    .card h2{margin:0;padding:18px 22px;background:#fff;border-bottom:1px solid #e7eef6;font-size:20px}
    .card .content{padding:22px}
    form label{display:block;font-weight:600;margin:14px 0 6px}
    .req{color:#0f6ab8;font-weight:700}
    input,select,textarea{width:100%;background:#fff;border:1px solid #d7e1eb;border-radius:12px;padding:12px 14px;font-size:15px}
    input:focus,select:focus,textarea:focus{outline:none;border-color:#0f6ab8;box-shadow:0 0 0 3px rgba(15,106,184,.15)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:700px){ .row{grid-template-columns:1fr} }
    .muted{font-size:13px;color:#5f7587}
    .actions{display:flex;gap:12px;align-items:center;margin-top:18px;flex-wrap:wrap}
    .btn{appearance:none;border:0;border-radius:12px;padding:12px 18px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
    .btn-primary{background:#2563eb;color:#fff}
    .btn-primary:hover{background:#1d4ed8}
    .btn-dark{background:#011a3a;color:#fff}
    .btn-dark:hover{background:#052032}
    footer{max-width:1100px;margin:26px auto 40px;padding:0 20px;color:#5b6f80;font-size:13px;text-align:center}
    footer img{margin-top:12px;max-width:160px}

    /* Checkboxes */
    .check-wrap{border:1px solid #cbd5e1;border-radius:6px;padding:8px 10px;margin-top:12px;background:#fff;display:flex;align-items:flex-start;gap:8px;box-shadow:0 1px 3px rgba(0,0,0,0.05)}
    .check-wrap input[type=checkbox]{margin-top:2px;width:16px;height:16px;accent-color:#0f6ab8;cursor:pointer}
    .check-wrap label{font-weight:500;margin:0}
    .check-wrap span{font-size:13px;color:#334155}

    /* Accessibility */
    :focus-visible{outline:2px solid #1c88c7;outline-offset:2px}
    img{max-width:100%}

    /* Hide any floating CTA elements that may exist site-wide on this standalone page */
    .floating-cta,.floating-cta-container,#floatingCta,.float-cta,.sticky-cta{display:none!important;visibility:hidden!important;pointer-events:none!important}
  </style>
</head>
<body class="offerte-page">

  <!-- Topbar -->
  <div class="ox-topbar" role="banner">
    <div class="ox-topbar-inner">
      <a class="ox-brand" aria-label="Home" href="index.html">
        <picture>
          <source media="(max-width:768px)" srcset="/images/logo4.svg"/>
          <img src="/images/logo3.svg" alt="OsmoseXpert"/>
        </picture>
      </a>
    </div>
  </div>

  <!-- Banner -->
  <section class="ox-image-banner">
    <div class="inner">
      <img src="offerte-aanvraag.png" width="1600" height="260" loading="eager" decoding="async"
           alt="OsmoseXpert offerteaanvraag banner"/>
    </div>
  </section>

  <main class="wrap">
    <p class="intro">
      Vul onderstaand formulier in voor een snelle offerte. Bedrijven en zelfstandigen kunnen hun bedrijfsgegevens
      toevoegen voor een correcte facturatie.
    </p>

    <section class="card">
      <h2>Uw gegevens</h2>
      <div class="content">
        <form id="offerteForm" action="/api/offerte" method="post" novalidate>

          <div class="row">
            <div>
              <label for="naam">Naam <span class="req">*</span></label>
              <input id="naam" name="naam" type="text" autocomplete="name" required/>
            </div>
            <div>
              <label for="email">E-mail <span class="req">*</span></label>
              <input id="email" name="email" type="email" inputmode="email" autocomplete="email" required/>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="tel">Telefoon</label>
              <input id="tel" name="telefoon" type="tel" inputmode="tel"
                     placeholder="Handig voor planning/updates"
                     autocomplete="tel"
                     pattern="^[0-9+()\s-]{6,}$"/>
            </div>
            <div>
              <label for="klant">Particulier of zakelijk (bedrijf / zelfstandige) <span class="req">*</span></label>
              <select id="klant" name="klanttype" required>
                <option value="">Maak een keuze…</option>
                <option value="b2c">Particulier</option>
                <option value="b2b">Zakelijk (bedrijf / zelfstandige)</option>
              </select>
            </div>
          </div>

          <!-- B2B extra's -->
          <div id="b2b-block" class="hidden">
            <div class="row">
              <div>
                <label for="bedrijfsnaam">Bedrijfsnaam <span class="req">*</span></label>
                <input id="bedrijfsnaam" name="bedrijfsnaam" type="text" autocomplete="organization"/>
              </div>
              <div>
                <label for="btw">BTW-nummer</label>
                <input id="btw" name="btw" type="text" placeholder="Bijv. BE0XXXXXXXXX"/>
                <p class="subtle-note">Voor Belgische nummers: BE + 10 cijfers. Buitenlands formaat is ook oké.</p>
              </div>
            </div>
          </div>

          <label for="adres">Adres (straat + nr, gemeente) <span class="req">*</span></label>
          <input id="adres" name="adres" type="text" autocomplete="street-address" required/>

          <div class="row">
            <div>
              <label for="dienst">Welke dienst? <span class="req">*</span></label>
              <select id="dienst" name="dienst" required>
                <option value="">Maak een keuze…</option>
                <option>Ramenreiniging</option>
                <option>Zonnepanelen</option>
                <option>Ramenreiniging + zonnepanelen (bundel)</option>
              </select>
            </div>

            <!-- Woningtype (B2C) -->
            <div id="woning-wrap">
              <label for="woning">Type woning <span class="req">*</span></label>
              <select id="woning" name="woningtype">
                <option value="">Maak een keuze…</option>
                <option>Rijwoning (2 gevels)</option>
                <option>Halfopen bebouwing (3 gevels)</option>
                <option>Vrijstaande woning (4 gevels)</option>
                <option>Villa / groot glas</option>
              </select>
            </div>

            <!-- Gebouwtype (B2B) -->
            <div id="gebouw-wrap" class="hidden">
              <label for="gebouw">Type gebouw <span class="req">*</span></label>
              <select id="gebouw" name="gebouwtype">
                <option value="">Maak een keuze…</option>
                <option>Kantoor</option>
                <option>Winkelruimte</option>
                <option>Showroom</option>
                <option>Horeca</option>
                <option>Praktijkruimte</option>
                <option>Magazijn</option>
                <option>Productiehal</option>
                <option>School / kinderopvang</option>
                <option>Zorginstelling</option>
                <option>Glasgevel (hoog)</option>
                <option>Anders</option>
              </select>
              <p class="subtle-note">Tip: vermeld etages, hoogte van glasgevels en bereikbaarheid in “Opmerkingen”.</p>
            </div>
          </div>

          <label for="extras">Extra's</label>
          <select id="extras" name="extras">
            <option value="">Geen extra's</option>
            <option>Veranda</option>
            <option>Glasgevel</option>
            <option>Garage(s)</option>
            <option>Rolluiken</option>
          </select>

          <label for="plan">Onderhoudsplan</label>
          <select id="plan" name="onderhoudsplan">
            <option>Geen plan</option>
            <option>Bronze (2x/jaar = 5% korting)</option>
            <option>Silver (4x/jaar = 10% korting)</option>
            <option>Gold (6x/jaar = 15% korting)</option>
          </select>

          <label for="opm">Opmerkingen</label>
          <textarea id="opm" name="opmerkingen" rows="4"
                    placeholder="Handig: aantal verdiepingen, bereikbaarheid, specifieke wensen…"></textarea>

          <div class="check-wrap">
            <input id="privacy" name="privacy" type="checkbox" required/>
            <label for="privacy">
              Ik ga akkoord met de <a href="privacy.html" target="_blank" rel="noopener">privacyvoorwaarden</a> en
              dat OsmoseXpert contact opneemt over mijn aanvraag.
            </label>
          </div>

          <div class="actions">
            <button class="btn btn-primary" type="submit">Verstuur offerte-aanvraag</button>
          </div>
          <p class="muted" style="margin-top:10px">Tevredenheidsgarantie: niet tevreden? Wij komen terug.</p>
        </form>
      </div>
    </section>
  </main>

  <footer>
    <p>Onze chatbot beantwoordt elke vraag die met OsmoseXpert te maken heeft.</p>
    <p>© <span id="y"></span> OsmoseXpert — Ronse &amp; omgeving • <a href="/faq.html?v=1.0">FAQ</a></p>
  </footer>

  <!-- Calendly (single include) -->
  <script async src="https://assets.calendly.com/assets/external/widget.js"></script>

  <script>
    // Jaar in footer
    document.getElementById('y').textContent = new Date().getFullYear();

    // Toggle B2B/B2C blocks
    const klantSel = document.getElementById('klant');
    const b2bBlock = document.getElementById('b2b-block');
    const bedrijfsnaam = document.getElementById('bedrijfsnaam');
    const btw = document.getElementById('btw');
    const woningWrap = document.getElementById('woning-wrap');
    const woning = document.getElementById('woning');
    const gebouwWrap = document.getElementById('gebouw-wrap');
    const gebouw = document.getElementById('gebouw');

    function syncMode(){
      const isB2B = klantSel && klantSel.value === 'b2b';
      if (b2bBlock){ b2bBlock.classList.toggle('hidden', !isB2B); }
      if (woningWrap){ woningWrap.classList.toggle('hidden', isB2B); }
      if (gebouwWrap){ gebouwWrap.classList.toggle('hidden', !isB2B); }

      // required toggles
      if (bedrijfsnaam){ bedrijfsnaam.required = !!isB2B; }
      if (woning){ woning.required = !isB2B; }
      if (gebouw){ gebouw.required = !!isB2B; }
    }

    if (klantSel){
      klantSel.addEventListener('change', syncMode);
      // init
      syncMode();
    }

    // Form submit via Formspree + redirect
    const form = document.getElementById('offerteForm');
    if (form){
      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        if(!form.reportValidity()) return;
        const FORMSPREE = "https://formspree.io/f/xvgbjdav";
        const data = new FormData(form);
        const btn = form.querySelector('button[type="submit"]');
        try{
          if(btn){ btn.disabled = true; btn.setAttribute('aria-busy','true'); }
          const res = await fetch(FORMSPREE, { method:'POST', body:data, headers:{'Accept':'application/json'} });
          if(res.ok){
            window.location.assign('bedankt.html?v=1.0');
          }else{
            alert('Kon niet verzenden. Probeer later opnieuw of mail naar info@osmose-xpert.be');
            if(btn){ btn.disabled = false; btn.removeAttribute('aria-busy'); }
          }
        }catch(err){
          alert('Er ging iets mis met verzenden. Controleer je verbinding en probeer opnieuw.');
          if(btn){ btn.disabled = false; btn.removeAttribute('aria-busy'); }
        }
      });
    }
  </script>

  <script defer src="assets/script.js"></script>
  <script src="/assets/js/ox-cookie-banner.js"></script>

<!-- BEGIN OsmoseXpert Cookie Consent (page-lock, modal, 2 buttons) -->
<style>
  :root {
    --brand:#0f6ab8;
    --brand2:#29ABE2;
    --dark:#002B45;
    --ok:#10b981;
    --white:#ffffff;
    --line:#0a2b45;
  }
  body.ox-lock { overflow:hidden!important; }
  .ox-cc-backdrop{position:fixed;inset:0;background:rgba(2,10,20,.65);backdrop-filter:saturate(120%) blur(2px);z-index:9998}
  .ox-cc-panel{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(92vw,980px);border-radius:16px;border:1px solid var(--line);overflow:hidden;z-index:9999;box-shadow:0 24px 60px rgba(0,0,0,.25)}
  .ox-cc-head{background:linear-gradient(180deg,#083A5C,var(--dark));color:var(--white);padding:18px 22px;border-bottom:3px solid var(--brand2)}
  .ox-cc-head h2{margin:0;font-size:18px}
  .ox-cc-body{background:#fff;padding:20px 22px}
  .ox-cc-grid{display:flex;gap:16px;flex-wrap:wrap;align-items:center}
  .ox-cc-text{flex:1;line-height:1.6;color:#0f172a}
  .ox-cc-text a{color:#0f6ab8;text-decoration:none;font-weight:600}
  .ox-cc-text a:hover{text-decoration:underline}
  .ox-cc-actions{display:flex;gap:10px;flex-wrap:wrap}
  .ox-btn{appearance:none;border:none;border-radius:10px;cursor:pointer;font-weight:700;font-size:14px;padding:12px 18px;transition:.2s}
  .ox-btn:focus{outline:3px solid #93c5fd;outline-offset:2px}
  .ox-btn.settings{background:#29ABE2;color:#fff}
  .ox-btn.settings:hover{background:#0f6ab8}
  .ox-btn.accept{background:#10b981;color:#fff}
  .ox-btn.accept:hover{background:#0d9469}
  .ox-modal{position:fixed;inset:0;display:none;z-index:10000;align-items:center;justify-content:center;padding:20px;background:rgba(2,10,20,.55)}
  .ox-modal[aria-hidden="false"]{display:flex}
  .ox-modal-card{width:min(92vw,720px);background:#fff;border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 20px 50px rgba(0,0,0,.25)}
  .ox-modal-hd{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid #e5e7eb}
  .ox-modal-hd h3{margin:0,font-size:18px}
  .ox-modal-bd{padding:16px 18px}
  .ox-modal-ft{display:flex;gap:10px;justify-content:flex-end;padding:14px 18px;border-top:1px solid #e5e7eb}
  .ox-opt{display:flex;gap:12px;border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin:8px 0}
  .ox-opt h4{margin:0 0 4px}
  .ox-switch{position:relative;width:44px;height:24px;flex:0 0 44px}
  .ox-switch input{opacity:0;width:0;height:0}
  .ox-slider{position:absolute;inset:0;background:#e5e7eb;border-radius:999px;transition:.2s}
  .ox-slider:before{content:"";position:absolute;height:18px;width:18px;left:3px;top:3px;background:#fff;border-radius:50%;box-shadow:0 1px 2px rgba(0,0,0,.2);transition:.2s}
  .ox-switch input:checked + .ox-slider{background:#0f6ab8}
  .ox-switch input:checked + .ox-slider:before{transform:translateX(20px)}
  .ox-btn.ghost{background:#fff;border:1px solid #e5e7eb;color:#0f172a}
  @media(max-width:720px){.ox-cc-grid{flex-direction:column;align-items:flex-start}.ox-cc-actions{width:100%;justify-content:flex-end}.ox-cc-actions .ox-btn{flex:1}}
  #ox-chatbase-container{position:fixed;right:16px;bottom:92px;width:380px;height:560px;display:none;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;background:#fff;z-index:9998;box-shadow:0 10px 30px rgba(0,0,0,.2)}
  #ox-chatbase-toggle{position:fixed;right:16px;bottom:16px;z-index:9998;appearance:none;border:none;border-radius:999px;padding:12px 14px;background:#0f6ab8;color:#fff;cursor:pointer;font:600 14px/1 Arial,Helvetica,sans-serif;box-shadow:0 6px 18px rgba(0,0,0,.18)}
  #ox-chatbase-toggle[hidden]{display:none}
</style>

<div id="ox-cc-root" hidden>
  <div class="ox-cc-backdrop" aria-hidden="false"></div>
  <section class="ox-cc-panel" role="dialog" aria-modal="true" aria-label="Cookiekeuze">
    <header class="ox-cc-head"><h2>Cookies bij OsmoseXpert</h2></header>
    <div class="ox-cc-body">
      <div class="ox-cc-grid">
        <p class="ox-cc-text">
          We gebruiken cookies om uw ervaring te verbeteren en onze prestaties te meten. U kunt <strong>instellingen aanpassen</strong> of <strong>alle cookies accepteren</strong>.
          Lees ons <a href="/cookiebeleid.html" target="_blank" rel="noopener">cookiebeleid</a> voor details.
        </p>
        <div class="ox-cc-actions">
          <button class="ox-btn settings" type="button" id="ox-btn-settings">Instellingen aanpassen</button>
          <button class="ox-btn accept" type="button" id="ox-btn-accept">Alles accepteren</button>
        </div>
      </div>
    </div>
  </section>
</div>

<div class="ox-modal" id="ox-settings-modal" aria-hidden="true" aria-label="Cookie-instellingen">
  <div class="ox-modal-card" role="document">
    <div class="ox-modal-hd"><h3>Cookie‑instellingen</h3><button class="ox-btn ghost" id="ox-btn-close" aria-label="Sluiten">Sluiten</button></div>
    <div class="ox-modal-bd">
      <div class="ox-opt">
        <div class="ox-switch" aria-hidden="true">
          <input type="checkbox" checked disabled>
          <span class="ox-slider"></span>
        </div>
        <div>
          <h4>Essentiële cookies <small>(altijd aan)</small></h4>
          <p>Nodig voor beveiliging, navigatie en basisfunctionaliteit.</p>
        </div>
      </div>
      <div class="ox-opt">
        <label class="ox-switch" for="ox-tog-analytics">
          <input type="checkbox" id="ox-tog-analytics">
          <span class="ox-slider"></span>
        </label>
        <div>
          <h4>Analytische cookies</h4>
          <p>Helpen ons gebruik en prestaties te meten (bijv. GA4).</p>
        </div>
      </div>
      <div class="ox-opt">
        <label class="ox-switch" for="ox-tog-marketing">
          <input type="checkbox" id="ox-tog-marketing">
          <span class="ox-slider"></span>
        </label>
        <div>
          <h4>Marketingcookies</h4>
          <p>Voor widgets/pixels en relevante content (bijv. chat).</p>
        </div>
      </div>
    </div>
    <div class="ox-modal-ft">
      <button class="ox-btn ghost" id="ox-btn-cancel">Annuleren</button>
      <button class="ox-btn accept" id="ox-btn-save">Bewaren</button>
    </div>
  </div>
</div>

<div id="ox-chatbase-container" aria-label="Digitale assistent"></div>
<button id="ox-chatbase-toggle" hidden type="button">Digitale assistent</button>

<script>
(function(){
  var KEY='ox_cookie_consent_v1';
  var GA_ID='G-FE95SCP0KD';
  var CHATBASE_IFRAME_SRC='https://www.chatbase.co/chatbot-iframe/TkHOZ_mxX3kecf30oT-ri';

  var root = document.getElementById('ox-cc-root');
  var btnAccept = document.getElementById('ox-btn-accept');
  var btnSettings = document.getElementById('ox-btn-settings');
  var modal = document.getElementById('ox-settings-modal');
  var btnSave = document.getElementById('ox-btn-save');
  var btnCancel = document.getElementById('ox-btn-cancel');
  var btnClose = document.getElementById('ox-btn-close');
  var togA = document.getElementById('ox-tog-analytics');
  var togM = document.getElementById('ox-tog-marketing');

  var chatBox = document.getElementById('ox-chatbase-container');
  var chatToggle = document.getElementById('ox-chatbase-toggle');
  var chatLoaded=false;

  function loadState(){ try { return JSON.parse(localStorage.getItem(KEY) || 'null'); } catch(e){ return null; } }
  function saveState(v){ localStorage.setItem(KEY, JSON.stringify(v)); }

  function show(){ root.hidden=false; document.body.classList.add('ox-lock'); }
  function hide(){ root.hidden=true; document.body.classList.remove('ox-lock'); }

  function openSettings(){ modal.setAttribute('aria-hidden','false'); }
  function closeSettings(){ modal.setAttribute('aria-hidden','true'); }

  function showOverlay(){ root.querySelector('.ox-cc-backdrop').style.display='block'; root.querySelector('.ox-cc-panel').style.display='block'; }
  function hideOverlay(){ root.querySelector('.ox-cc-backdrop').style.display='none'; root.querySelector('.ox-cc-panel').style.display='none'; }

  function apply(cons){ 
    document.documentElement.dataset.ccAnalytics = cons.analytics ? '1' : '0';
    document.documentElement.dataset.ccMarketing = cons.marketing ? '1' : '0';
    document.dispatchEvent(new CustomEvent('cookie-consent-changed',{detail:cons}));
    if(cons.analytics) loadGA();
    if(cons.marketing) enableChatbase(); else disableChatbase();
  }

  function acceptAll(){ 
    var cons = { essential:true, analytics:true, marketing:true, ts:Date.now() }; 
    saveState(cons); apply(cons); hide(); hideOverlay(); 
  }

  btnAccept.addEventListener('click', acceptAll);
  btnSettings.addEventListener('click', function(){ openSettings(); /* keep locked */ });

  btnCancel.addEventListener('click', function(){ closeSettings(); /* still locked */ });
  btnClose.addEventListener('click', function(){ closeSettings(); });

  btnSave.addEventListener('click', function(){ 
    var cons = { essential:true, analytics: !!togA.checked, marketing: !!togM.checked, ts:Date.now() }; 
    saveState(cons); apply(cons); hide(); closeSettings(); hideOverlay(); 
  });

  var current = loadState();
  if(!current){ show(); showOverlay(); }
  else { apply(current); /* already chosen => unlocked */ }

  window.cookieConsent = {
    open: function(){ show(); showOverlay(); },
    get: function(){ return loadState(); },
    set: function(opts){ var prev=loadState()||{essential:true,analytics:false,marketing:false}; var cons=Object.assign({},prev,opts,{ts:Date.now()}); saveState(cons); apply(cons); }
  };

  function loadGA(){ 
    if(!GA_ID || document.getElementById('ga4-src')) return; 
    var s1=document.createElement('script'); s1.async=true; s1.src='https://www.googletagmanager.com/gtag/js?id='+GA_ID; s1.id='ga4-src'; document.head.appendChild(s1);
    var s2=document.createElement('script'); s2.id='ga4-init'; s2.text="window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config','"+GA_ID+"',{anonymize_ip:true});"; document.head.appendChild(s2);
  }

  function enableChatbase(){ 
    chatToggle.hidden=false; 
    if(!chatLoaded){ 
      var ifr=document.createElement('iframe'); 
      ifr.src=CHATBASE_IFRAME_SRC; ifr.width='100%'; ifr.style.height='100%'; ifr.setAttribute('frameborder','0'); 
      chatBox.appendChild(ifr); chatLoaded=true; 
    } 
  }
  function disableChatbase(){ chatToggle.hidden=true; chatBox.style.display='none'; }
  chatToggle.addEventListener('click', function(){ chatBox.style.display = (chatBox.style.display==='block'?'none':'block'); });
})();
</script>
<!-- END OsmoseXpert Cookie Consent -->

</body>
</html>
