<!doctype html>
<html lang="nl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Vraag uw vrijblijvende offerte aan voor ramen- en zonnepanelenreiniging in Ronse, Oudenaarde en Kluisbergen. Binnen 24 uur een transparant prijsvoorstel van OsmoseXpert.">
  <title>Offerte aanvragen ‚Äî OsmoseXpert</title>
  <style>
    body { box-sizing: border-box; }
    *, *::before, *::after { box-sizing: inherit; }

    html, body {
      margin: 0; padding: 0; height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #f8fafc; color: #1e293b; line-height: 1.6;
    }

    header {
      background: linear-gradient(135deg, #0f6ab8 0%, #0a4d8a 100%);
      color: white; padding: 24px 20px; text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .header-content { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px; margin-bottom: 12px; }
    .header-logo { height: 200px; width: auto; }
    header h1 { margin: 0; font-size: 28px; font-weight: 700; }
    header p { margin: 0; opacity: 0.95; font-size: 16px; }

    main { max-width: 800px; margin: 0 auto; padding: 20px; padding-right: 100px; }

    .progress-bar {
      position: fixed; top: 0; right: 120px; height: 100%; width: 40px;
      display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 12px;
      z-index: 1000; padding: 40px 0; pointer-events: none;
    }
    .progress-bar.stop-at-footer { position: absolute; top: auto; bottom: 0; }

    .progress-meter { display: flex; flex-direction: column; align-items: center; gap: 10px; flex: 1; justify-content: center; }
    .progress-track {
      background: rgba(226, 232, 240, 0.6); width: 6px; height: 60%; max-height: 400px; border-radius: 3px; overflow: hidden; position: relative;
      display: flex; flex-direction: column; justify-content: flex-end; box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
    }
    .progress-fill { background: linear-gradient(180deg, #10b981 0%, #059669 100%); width: 100%; height: 0%; transition: height 0.4s cubic-bezier(0.4,0,0.2,1); border-radius: 0 0 3px 3px; box-shadow: 0 -2px 8px rgba(16,185,129,0.3); }
    .progress-percentage { font-size: 24px; font-weight: 600; color: #64748b; letter-spacing: -0.5px; }

    .form-container { background: white; border-radius: 12px; padding: 32px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .form-container h2 { margin: 0 0 24px; font-size: 24px; color: #0f172a; }

    label { display: block; margin-bottom: 6px; font-weight: 600; color: #334155; font-size: 14px; }
    .req { color: #dc2626; }

    input, select, textarea {
      width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 15px; font-family: inherit; transition: all 0.2s; background: white;
    }
    input:focus, select:focus, textarea:focus { outline: none; border-color: #0f6ab8; box-shadow: 0 0 0 3px rgba(15,106,184,0.1); }
    input[type="checkbox"] { width: auto; margin-right: 8px; }

    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
    .row > div { margin-bottom: 0; }

    form > label, form > input, form > select, form > textarea, form > div:not(.row):not(.check-wrap):not(.actions) { margin-bottom: 16px; }

    .hidden { display: none !important; }
    .muted { font-size: 13px; color: #64748b; margin: 4px 0 0; }

    .error-message { color: #dc2626; font-size: 13px; margin-top: 4px; display: none; }
    .field-error input, .field-error select, .field-error textarea { border-color: #dc2626; }
    .field-error .error-message { display: block; }
    .field-success input, .field-success select, .field-success textarea { border-color: #10b981; }

    .tooltip { position: relative; display: inline-block; cursor: help; margin-left: 4px; }
    .tooltiptext {
      visibility: hidden; width: 220px; background-color: #1e293b; color: white; text-align: center; border-radius: 6px; padding: 8px;
      position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -110px; opacity: 0; transition: opacity 0.3s; font-size: 12px; font-weight: normal;
    }
    .tooltiptext::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: #1e293b transparent transparent transparent; }
    .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }

    .check-wrap { display: flex; align-items: flex-start; margin-bottom: 12px; }
    .check-wrap input[type="checkbox"] { margin-top: 4px; flex-shrink: 0; }
    .check-wrap label { margin: 0; font-weight: 400; font-size: 14px; }
    .check-wrap a { color: #0f6ab8; text-decoration: none; }
    .check-wrap a:hover { text-decoration: underline; }

    .info-box {
      display: flex; gap: 16px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border: 2px solid #86efac; border-radius: 12px; padding: 20px; margin-bottom: 16px; box-shadow: 0 2px 8px rgba(34,197,94,0.08);
    }
    .info-icon {
      flex-shrink: 0; width: 40px; height: 40px; background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
      color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; box-shadow: 0 2px 8px rgba(34,197,94,0.3);
    }
    .info-content { flex: 1; }
    .info-content h3 { margin: 0 0 8px; font-size: 18px; color: #0f172a; font-weight: 700; }
    .info-content p { margin: 0 0 8px; color: #334155; font-size: 14px; line-height: 1.6; }
    .info-content p:last-child { margin-bottom: 0; }
    .info-legal { font-size: 13px; color: #64748b; margin-top: 12px; }
    .info-legal a { color: #0f6ab8; text-decoration: none; font-weight: 600; }
    .info-legal a:hover { text-decoration: underline; }

    .actions { margin-top: 24px; }
    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 14px 28px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
    .btn-primary { background: linear-gradient(135deg, #0f6ab8 0%, #0a4d8a 100%); color: white; box-shadow: 0 2px 8px rgba(15,106,184,0.3); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(15,106,184,0.4); }
    .btn-primary:active { transform: translateY(0); }
    .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

    footer { margin-top: 48px; }
    .footer-banner { background: linear-gradient(135deg, #0f6ab8 0%, #0a4d8a 100%); padding: 80px 20px 32px; text-align: center; position: relative; min-height: 240px; }
    .footer-banner::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 60px; background: #f8fafc; z-index: 0; }
    .footer-banner-logo { height: 200px; width: auto; position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%); z-index: 1; }
    .footer-info { background: #f8fafc; padding: 24px; text-align: center; color: #64748b; font-size: 14px; }
    .footer-info p { margin: 8px 0; }
    .footer-links { margin-top: 12px; }
    footer a { color: #0f6ab8; text-decoration: none; font-weight: 600; transition: color 0.2s; }
    footer a:hover { color: #0a4d8a; text-decoration: underline; }

    /* Cookie Consent Styles */
    #ox-cc-root { position: fixed; inset: 0; z-index: 9999; }
    .ox-cc-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); }
    .ox-cc-panel {
      position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
      max-width: 600px; width: calc(100% - 40px); background: white; border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2); padding: 24px;
    }
    .ox-cc-head h2 { margin: 0 0 16px; font-size: 20px; color: #0f172a; }
    .ox-cc-text { margin: 0 0 20px; color: #475569; line-height: 1.6; }
    .ox-cc-actions { display: flex; gap: 12px; flex-wrap: wrap; }
    .ox-btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
    .ox-btn.settings { background: #f1f5f9; color: #334155; }
    .ox-btn.settings:hover { background: #e2e8f0; }
    .ox-btn.accept { background: #0f6ab8; color: white; }
    .ox-btn.accept:hover { background: #0a4d8a; }
    .ox-btn.ghost { background: transparent; color: #64748b; }
    .ox-btn.ghost:hover { background: #f1f5f9; }

    .ox-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); display: flex; align-items: center; justify-content: center; z-index: 10000; padding: 20px; }
    .ox-modal[aria-hidden="true"] { display: none; }
    .ox-modal-card { background: white; border-radius: 12px; max-width: 500px; width: 100%; max-height: 90%; overflow-y: auto; }
    .ox-modal-hd { display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid #e2e8f0; }
    .ox-modal-hd h3 { margin: 0; font-size: 18px; color: #0f172a; }
    .ox-modal-bd { padding: 24px; }
    .ox-opt { display: flex; gap: 16px; margin-bottom: 20px; }
    .ox-opt:last-child { margin-bottom: 0; }
    .ox-opt h4 { margin: 0 0 4px; font-size: 15px; color: #0f172a; }
    .ox-opt h4 small { font-weight: 400; color: #64748b; }
    .ox-opt p { margin: 0; font-size: 13px; color: #64748b; }

    .ox-switch { position: relative; display: inline-block; width: 48px; height: 26px; flex-shrink: 0; }
    .ox-switch input { opacity: 0; width: 0; height: 0; }
    .ox-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #cbd5e1; transition: 0.3s; border-radius: 26px; }
    .ox-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: 0.3s; border-radius: 50%; }
    input:checked + .ox-slider { background-color: #0f6ab8; }
    input:checked + .ox-slider:before { transform: translateX(22px); }
    input:disabled + .ox-slider { opacity: 0.5; cursor: not-allowed; }

    .ox-modal-ft { display: flex; justify-content: flex-end; gap: 12px; padding: 20px 24px; border-top: 1px solid #e2e8f0; }
    .ox-lock { overflow: hidden; }

    @media (max-width: 640px) {
      .row { grid-template-columns: 1fr; }
      .form-container { padding: 20px; }
      .header-content { flex-direction: column; gap: 16px; }
      .header-logo { height: 80px; }
      header h1 { font-size: 24px; }
      main { padding-right: 20px; }
      .progress-bar {
        position: fixed; top: auto; bottom: 0; right: 0; left: 0; width: 100%; height: 60px;
        flex-direction: row; align-items: center; justify-content: center; gap: 16px; padding: 0 20px; background: white; box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
      }
      .progress-meter { flex-direction: row; flex: 0; }
      .progress-track { width: 120px; height: 30px; max-height: none; flex-direction: row; justify-content: flex-start; }
      .progress-fill { height: 100%; width: 0%; border-radius: 20px 0 0 20px; }
      .progress-percentage { font-size: 20px; }
      body { padding-bottom: 60px; }
      .ox-cc-panel { bottom: 0; left: 0; transform: none; width: 100%; border-radius: 12px 12px 0 0; }
      .ox-cc-actions { flex-direction: column; }
      .ox-btn { width: 100%; justify-content: center; }
      .footer-banner-logo { height: 140px; }
      .footer-banner { padding: 24px 20px; }
    }
    @media (max-width: 400px) { .footer-banner-logo { height: 110px; } }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <link rel="canonical" href="https://osmose-xpert.be/offerte.html">
 </head>
 <body>
  <header>
   <div class="header-content">
    <h1>Offerte aanvragen</h1>
    <p>Vul dit formulier in en ontvang binnen 24u uw persoonlijke prijsvoorstel ‚Äî zonder verplichting.</p>
   </div>
  </header>

  <main>
   <section class="progress-bar">
    <div class="progress-meter">
     <div class="progress-percentage" id="progressPercentage">0%</div>
     <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
    </div>
   </section>

   <section class="form-container">
    <h2>üíß Uw gegevens</h2>

    <!-- PURE HTML SUBMIT + REDIRECT -->
    <form id="offerteForm"
          action="https://formspree.io/f/xnnqbpvq?redirect=https://osmose-xpert.be/bedankt.html"
          method="POST">

      <label for="klant">Type klant <span class="req">*</span></label>
      <select id="klant" name="klanttype" required>
        <option value="">Maak een keuze‚Ä¶</option>
        <option value="particulier">Particulier</option>
        <option value="b2b">Bedrijf / organisatie</option>
      </select>
      <div class="error-message">Selecteer uw klanttype</div>

      <div class="row">
        <div>
          <label for="voornaam">Voornaam <span class="req">*</span></label>
          <input id="voornaam" name="voornaam" type="text" autocomplete="given-name" required placeholder="Jan">
          <div class="error-message">Vul uw voornaam in</div>
        </div>
        <div>
          <label for="achternaam">Achternaam <span class="req">*</span></label>
          <input id="achternaam" name="achternaam" type="text" autocomplete="family-name" required placeholder="Janssens">
          <div class="error-message">Vul uw achternaam in</div>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="email">E-mailadres <span class="req">*</span></label>
          <input id="email" name="email" type="email" autocomplete="email" required placeholder="jan@voorbeeld.be">
          <div class="error-message">Vul een geldig e-mailadres in</div>
        </div>
        <div>
          <label for="tel">Telefoonnummer <span class="req">*</span></label>
          <input id="tel" name="telefoon" type="tel" inputmode="tel" pattern="[\d +()./-]{6,}" required placeholder="0470 12 34 56">
          <div class="error-message">Vul uw telefoonnummer in</div>
        </div>
      </div>

      <div id="b2b-block" class="hidden">
        <div class="row">
          <div>
            <label for="bedrijfsnaam">Bedrijfsnaam <span class="req">*</span></label>
            <input id="bedrijfsnaam" name="bedrijfsnaam" type="text" autocomplete="organization" placeholder="Naam van uw bedrijf">
            <div class="error-message">Vul uw bedrijfsnaam in</div>
          </div>
          <div>
            <label for="btw">BTW-nummer</label>
            <input id="btw" name="btw" type="text" placeholder="BE0123456789">
            <p class="muted">Voor Belgische nummers: BE + 10 cijfers. Buitenlands formaat is ook ok√©.</p>
          </div>
        </div>
      </div>

      <label for="adres">Adres (straat + nr, gemeente) <span class="req">*</span></label>
      <input id="adres" name="adres" type="text" autocomplete="street-address" required placeholder="Hoofdstraat 123, 9600 Ronse">
      <div class="error-message">Vul uw adres in</div>

      <div class="row">
        <div>
          <label for="dienst">Welke dienst? <span class="req">*</span></label>
          <select id="dienst" name="dienst" required>
            <option value="">Maak een keuze‚Ä¶</option>
            <option>Ramenreiniging</option>
            <option>Zonnepanelen</option>
            <option>Ramenreiniging + zonnepanelen (bundel)</option>
          </select>
          <div class="error-message">Selecteer een dienst</div>
        </div>

        <div id="woning-wrap">
          <label for="woning">Type woning <span class="req">*</span></label>
          <select id="woning" name="woningtype">
            <option value="">Maak een keuze‚Ä¶</option>
            <option>Rijwoning (2 gevels)</option>
            <option>Halfopen bebouwing (3 gevels)</option>
            <option>Vrijstaande woning (4 gevels)</option>
            <option>Villa / groot glas</option>
          </select>
          <div class="error-message">Selecteer uw woningtype</div>
        </div>

        <div id="gebouw-wrap" class="hidden">
          <label for="gebouw">Type gebouw <span class="req">*</span></label>
          <select id="gebouw" name="gebouwtype">
            <option value="">Maak een keuze‚Ä¶</option>
            <option>Kantoor</option><option>Winkelruimte</option><option>Showroom</option><option>Horeca</option><option>Praktijkruimte</option><option>Magazijn</option><option>Productiehal</option><option>School / kinderopvang</option><option>Zorginstelling</option><option>Glasgevel (hoog)</option><option>Anders</option>
          </select>
          <p class="muted">Tip: vermeld etages, hoogte van glasgevels en bereikbaarheid in "Opmerkingen".</p>
          <div class="error-message">Selecteer uw gebouwtype</div>
        </div>
      </div>

      <label for="extras">Extra's (optioneel)
        <span class="tooltip">‚ÑπÔ∏è
          <span class="tooltiptext">Heeft u extra glasoppervlakken die gereinigd moeten worden?</span>
        </span>
      </label>
      <select id="extras" name="extras">
        <option value="">Geen extra's</option><option>Veranda</option><option>Glasgevel</option><option>Garage(s)</option><option>Rolluiken</option>
      </select>

      <label for="plan">Onderhoudsplan
        <span class="tooltip">üí∞
          <span class="tooltiptext">Bespaar tot 15% met een onderhoudsabonnement! Regelmatig onderhoud houdt uw ramen en panelen in topconditie.</span>
        </span>
      </label>
      <select id="plan" name="onderhoudsplan">
        <option>Geen plan</option>
        <option>Bronze (2x/jaar = 5% korting)</option>
        <option>Silver (4x/jaar = 10% korting)</option>
        <option>Gold (6x/jaar = 15% korting)</option>
      </select>

      <label for="contact">Hoe mogen we u contacteren? <span class="req">*</span></label>
      <select id="contact" name="contactvoorkeur" required>
        <option value="">Maak een keuze‚Ä¶</option>
        <option value="email">Bij voorkeur per e-mail</option>
        <option value="telefoon">Telefonisch contact is ok√©</option>
        <option value="beide">E-mail of telefoon, beide prima</option>
      </select>
      <p class="muted">üí¨ We respecteren uw voorkeur. Bij e-mail ontvangt u de offerte zonder telefonisch contact.</p>
      <div class="error-message">Selecteer uw contactvoorkeur</div>

      <label for="opm" style="margin-top: 24px;">Opmerkingen</label>
      <textarea id="opm" name="opmerkingen" rows="4" placeholder="Handig: aantal verdiepingen, bereikbaarheid, specifieke wensen, beste tijdstip voor contact‚Ä¶"></textarea>

      <div class="info-box">
        <div class="info-icon">‚úì</div>
        <div class="info-content">
          <h3>Vrijblijvend</h3>
          <p><strong>Deze aanvraag is niet bindend.</strong> We gebruiken uw gegevens enkel om uw offerte te bezorgen.</p>
          <p class="info-legal">Door te verzenden gaat u akkoord met onze <a href="privacy.html" target="_blank" rel="noopener">privacyverklaring</a> en <a href="voorwaarden.html" target="_blank" rel="noopener">algemene voorwaarden</a>.</p>
        </div>
      </div>

      <!-- Honeypot & subject -->
      <input type="text" name="_gotcha" tabindex="-1" autocomplete="off" style="position:absolute;left:-9999px;">
      <input type="hidden" name="_subject" value="Nieuwe offerte-aanvraag via osmose-xpert.be">

      <div class="actions" aria-live="polite">
        <button class="btn btn-primary" type="submit" id="submitBtn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
          Verstuur offerte-aanvraag
        </button>
      </div>
    </form>
   </section>
  </main>

  <footer>
   <div class="footer-banner">
     <img src="https://i.imgur.com/CUAlnGg.png" loading="lazy" alt="OsmoseXpert logo" class="footer-banner-logo" onerror="this.style.display='none';">
   </div>
   <div class="footer-info">
    <p>¬© <span id="y"></span> OsmoseXpert ‚Äî Ronse &amp; omgeving</p>
    <p class="footer-links"><a href="/faq.html">FAQ</a> ‚Ä¢ <a href="/privacy.html">Privacy</a> ‚Ä¢ <a href="/voorwaarden.html">Voorwaarden</a></p>
   </div>
  </footer>

  <!-- Cookie consent -->
  <div id="ox-cc-root" hidden>
   <div class="ox-cc-backdrop" aria-hidden="false"></div>
   <section class="ox-cc-panel" role="dialog" aria-modal="true" aria-label="Cookiekeuze">
    <header class="ox-cc-head"><h2>Cookies bij OsmoseXpert</h2></header>
    <div class="ox-cc-body">
     <div class="ox-cc-grid">
      <p class="ox-cc-text">We gebruiken cookies om uw ervaring te verbeteren en onze prestaties te meten. U kunt <strong>instellingen aanpassen</strong> of <strong>alle cookies accepteren</strong>. Lees ons <a href="/cookiebeleid.html" target="_blank" rel="noopener">cookiebeleid</a> voor details.</p>
      <div class="ox-cc-actions">
        <button class="ox-btn settings" type="button" id="ox-btn-settings">Instellingen aanpassen</button>
        <button class="ox-btn accept" type="button" id="ox-btn-accept">Alles accepteren</button>
      </div>
     </div>
    </div>
   </section>
  </div>

  <div class="ox-modal" id="ox-settings-modal" aria-hidden="true" aria-label="Cookie-instellingen">
   <div class="ox-modal-card" role="document">
    <div class="ox-modal-hd">
     <h3>Cookie-instellingen</h3><button class="ox-btn ghost" id="ox-btn-close" aria-label="Sluiten">Sluiten</button>
    </div>
    <div class="ox-modal-bd">
     <div class="ox-opt">
      <div class="ox-switch" aria-hidden="true"><input type="checkbox" checked disabled> <span class="ox-slider"></span></div>
      <div><h4>Essenti√´le cookies <small>(altijd aan)</small></h4><p>Nodig voor beveiliging, navigatie en basisfunctionaliteit.</p></div>
     </div>
     <div class="ox-opt">
      <label class="ox-switch" for="ox-tog-analytics"><input type="checkbox" id="ox-tog-analytics"><span class="ox-slider"></span></label>
      <div><h4>Analytische cookies</h4><p>Helpen ons gebruik en prestaties te meten (bijv. GA4).</p></div>
     </div>
     <div class="ox-opt">
      <label class="ox-switch" for="ox-tog-marketing"><input type="checkbox" id="ox-tog-marketing"><span class="ox-slider"></span></label>
      <div><h4>Marketingcookies</h4><p>Voor widgets/pixels en relevante content.</p></div>
     </div>
    </div>
    <div class="ox-modal-ft">
      <button class="ox-btn ghost" id="ox-btn-cancel">Annuleren</button>
      <button class="ox-btn accept" id="ox-btn-save">Bewaren</button>
    </div>
   </div>
  </div>

  <script>
    // Jaar
    document.getElementById('y').textContent = new Date().getFullYear();

    // Progress + validatie feedback (zonder submit-interceptie)
    function updateProgress() {
      const form = document.getElementById('offerteForm');
      const allRequiredFields = form.querySelectorAll('[required]');
      const visibleRequiredFields = Array.from(allRequiredFields).filter(field => {
        if (field.offsetParent === null) return false;
        let parent = field.parentElement;
        while (parent && parent !== form) {
          if (parent.classList.contains('hidden') || parent.offsetParent === null) return false;
          parent = parent.parentElement;
        }
        return true;
      });
      const filledFields = visibleRequiredFields.filter(field => {
        if (field.type === 'checkbox') return field.checked;
        if (field.tagName === 'SELECT') return field.value.trim() !== '';
        const minLength = (field.id === 'voornaam' || field.id === 'achternaam') ? 2 : 3;
        return field.value.trim().length >= minLength;
      });
      const progress = visibleRequiredFields.length > 0 ? (filledFields.length / visibleRequiredFields.length) * 100 : 0;
      const progressFill = document.getElementById('progressFill');
      if (window.innerWidth <= 640) { progressFill.style.width = progress + '%'; progressFill.style.height = '100%'; }
      else { progressFill.style.height = progress + '%'; progressFill.style.width = '100%'; }
      document.getElementById('progressPercentage').textContent = Math.round(progress) + '%';
    }

    function validateField(field) {
      const container = field.closest('.field, .row > div') || (field.parentElement && field.parentElement.tagName !== 'FORM' ? field.parentElement : null);
      const errEl = (field.nextElementSibling && field.nextElementSibling.classList && field.nextElementSibling.classList.contains('error-message')) ? field.nextElementSibling : null;
      const setState = (state) => {
        if (container) {
          container.classList.remove('field-error','field-success');
          if (state) container.classList.add(state);
        }
        if (errEl) errEl.style.display = state === 'field-error' ? 'block' : 'none';
      };

      if (field.hasAttribute('required') && !field.value.trim()) { setState('field-error'); return false; }
      if (field.type === 'email' && field.value && !field.value.includes('@')) { setState('field-error'); return false; }
      if (field.type === 'tel' && field.value && field.value.replace(/\D/g,'').length < 6) { setState('field-error'); return false; }
      if (field.tagName === 'SELECT' && field.hasAttribute('required') && !field.value.trim()) { setState('field-error'); return false; }

      setState('field-success'); return true;
    }

    const klantSel = document.getElementById('klant');
    const b2bBlock = document.getElementById('b2b-block');
    const bedrijfsnaam = document.getElementById('bedrijfsnaam');
    const woningWrap = document.getElementById('woning-wrap');
    const woning = document.getElementById('woning');
    const gebouwWrap = document.getElementById('gebouw-wrap');
    const gebouw = document.getElementById('gebouw');

    function syncMode(){
      const isB2B = klantSel && klantSel.value === 'b2b';
      if(b2bBlock){ b2bBlock.classList.toggle('hidden', !isB2B); }
      if(woningWrap){ woningWrap.classList.toggle('hidden', isB2B); }
      if(gebouwWrap){ gebouwWrap.classList.toggle('hidden', !isB2B); }
      if(bedrijfsnaam){ bedrijfsnaam.required = !!isB2B; }
      if(woning){ woning.required = !isB2B; }
      if(gebouw){ gebouw.required = !!isB2B; }
      updateProgress();
    }
    if(klantSel){ klantSel.addEventListener('change', syncMode); syncMode(); }

    const form = document.getElementById('offerteForm');
    if (form) {
      const inputs = form.querySelectorAll('input, select, textarea');
      inputs.forEach(input => {
        input.addEventListener('input', () => { validateField(input); });
        input.addEventListener('blur', () => { validateField(input); updateProgress(); });
        input.addEventListener('change', () => { updateProgress(); });
      });
    }

    updateProgress();

    // Stop progress bar voor footer banner
    function handleProgressBarPosition() {
      const progressBar = document.querySelector('.progress-bar');
      const footer = document.querySelector('footer');
      if (!progressBar || !footer || window.innerWidth <= 640) return;
      const footerRect = footer.getBoundingClientRect();
      const windowHeight = window.innerHeight;
      const progressBarHeight = progressBar.offsetHeight;
      if (footerRect.top < windowHeight) {
        progressBar.classList.add('stop-at-footer');
        const footerTop = footer.offsetTop;
        progressBar.style.top = (footerTop - progressBarHeight - 40) + 'px';
      } else {
        progressBar.classList.remove('stop-at-footer');
        progressBar.style.top = '';
      }
    }
    window.addEventListener('scroll', handleProgressBarPosition);
    window.addEventListener('resize', handleProgressBarPosition);
    handleProgressBarPosition();

    // Cookie consent (ongewijzigd, laadt GA enkel bij toestemming)
    (function(){
      var KEY='ox_cookie_consent_v1';
      var GA_ID='G-FE95SCP0KD';
      var root=document.getElementById('ox-cc-root');
      var btnAccept=document.getElementById('ox-btn-accept');
      var btnSettings=document.getElementById('ox-btn-settings');
      var modal=document.getElementById('ox-settings-modal');
      var btnSave=document.getElementById('ox-btn-save');
      var btnCancel=document.getElementById('ox-btn-cancel');
      var btnClose=document.getElementById('ox-btn-close');
      var togA=document.getElementById('ox-tog-analytics');
      var togM=document.getElementById('ox-tog-marketing');

      function loadState(){ try{return JSON.parse(localStorage.getItem(KEY)||'null')}catch(e){return null} }
      function saveState(v){ localStorage.setItem(KEY, JSON.stringify(v)); }
      function show(){ root.hidden=false; document.body.classList.add('ox-lock'); }
      function hide(){ root.hidden=true; document.body.classList.remove('ox-lock'); }
      function openSettings(){ modal.setAttribute('aria-hidden','false'); }
      function closeSettings(){ modal.setAttribute('aria-hidden','true'); }
      function showOverlay(){ root.querySelector('.ox-cc-backdrop').style.display='block'; root.querySelector('.ox-cc-panel').style.display='block'; }
      function hideOverlay(){ root.querySelector('.ox-cc-backdrop').style.display='none'; root.querySelector('.ox-cc-panel').style.display='none'; }
      function apply(cons){ document.documentElement.dataset.ccAnalytics = cons.analytics ? '1' : '0'; document.documentElement.dataset.ccMarketing = cons.marketing ? '1' : '0'; if(cons.analytics) loadGA(); }
      function acceptAll(){ var cons={essential:true,analytics:true,marketing:true,ts:Date.now()}; saveState(cons); apply(cons); hide(); hideOverlay(); }
      if(btnAccept) btnAccept.addEventListener('click', acceptAll);
      if(btnSettings) btnSettings.addEventListener('click', function(){ openSettings(); });
      if(btnCancel) btnCancel.addEventListener('click', function(){ closeSettings(); });
      if(btnClose) btnClose.addEventListener('click', function(){ closeSettings(); });
      if(btnSave) btnSave.addEventListener('click', function(){ var cons={ essential:true, analytics:!!togA.checked, marketing:!!togM.checked, ts:Date.now() }; saveState(cons); apply(cons); hide(); closeSettings(); hideOverlay(); });
      var current=loadState(); if(!current){ show(); showOverlay(); } else { apply(current); }
      function loadGA(){ if(!GA_ID || document.getElementById('ga4-src')) return; var s1=document.createElement('script'); s1.async=true; s1.src='https://www.googletagmanager.com/gtag/js?id='+GA_ID; s1.id='ga4-src'; document.head.appendChild(s1); var s2=document.createElement('script'); s2.id='ga4-init'; s2.text="window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config','"+GA_ID+"',{anonymize_ip:true});"; document.head.appendChild(s2); }
    })();
  </script>
</body>
</html>
