<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Offerte – OsmoseXpert</title>
  <meta name="description" content="Ontvang snel een transparante offerte voor ramen, glasgevels of zonnepanelen. Antwoord binnen 24 uur."/>

  <!-- Basis styles/vars -->
  <style>
    :root{--brand:#0f6ab8;--brand2:#29ABE2;--ink:#1e293b;--bg:#f6f9fc;--dark:#011a3a}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Segoe UI',system-ui,-apple-system,BlinkMacSystemFont,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.6;box-sizing:border-box}
    a{color:var(--brand);text-decoration:none;transition:color 0.2s ease}
    a:hover{text-decoration:underline;color:#0d5aa3}
    .wrap{max-width:1100px;margin:0 auto;padding:0 20px}

    /* utility */
    .hidden{display:none!important}

    /* Subhero (zoals contact.html) */
    .subhero{background:linear-gradient(135deg,#03304f,#00304e,#0a4a6b);color:#fff;padding:50px 20px;display:flex;align-items:center;justify-content:center;margin-bottom:32px;position:relative;overflow:hidden}
    .subhero:before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');opacity:0.4}
    .subhero .inner{max-width:1100px;width:100%;position:relative;z-index:1}
    .subhero h1{margin:0 0 8px 20px;font-size:clamp(26px,3vw,32px);color:#f3f7fb;font-weight:700}
    .subhero .subtitle{color:#cfe4ff;font-size:clamp(16px,1.6vw,19px);font-weight:500;margin-left:24px}
    @media (max-width:900px){.subhero{padding:30px 16px}.subhero h1{margin:0;font-size:24px}.subhero .subtitle{font-size:16px;margin:8px 0 0 0}}

    /* Card/form layout */
    .card{background:#fff;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,.08);overflow:hidden;border:1px solid rgba(15,106,184,.08);transition:all 0.3s ease}
    .card:hover{box-shadow:0 12px 40px rgba(0,0,0,.12);transform:translateY(-2px)}
    .card h2{margin:0;padding:24px 28px;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-bottom:2px solid #e2e8f0;font-size:22px;color:#0a3d62;font-weight:600;position:relative}
    .card h2:after{content:'';position:absolute;bottom:-2px;left:28px;width:60px;height:3px;background:linear-gradient(90deg,var(--brand),var(--brand2));border-radius:2px}
    .card .content{padding:28px}

    /* Progress bar */
    .progress-bar{width:100%;height:6px;background:#e2e8f0;border-radius:3px;margin:0 0 24px 0;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,#0f6ab8,#29ABE2);border-radius:3px;transition:width 0.5s ease;width:0%}

    form label{display:block;font-weight:600;margin:20px 0 8px;color:#334155;font-size:15px;position:relative}
    .req{color:#dc2626;font-weight:700}
    input,select,textarea{width:100%;background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:14px 16px;font-size:15px;transition:all 0.2s ease;box-shadow:0 1px 3px rgba(0,0,0,.05);font-family:inherit}
    input:hover,select:hover,textarea:hover{border-color:#cbd5e1}
    input:focus,select:focus,textarea:focus{outline:none;border-color:#0f6ab8;box-shadow:0 0 0 4px rgba(15,106,184,.12);transform:translateY(-1px)}
    input:invalid:not(:focus):not(:placeholder-shown){border-color:#dc2626;box-shadow:0 0 0 4px rgba(220,38,38,.1)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:6px}
    @media (max-width:700px){.row{grid-template-columns:1fr;gap:16px}}
    .muted{font-size:13px;color:#64748b;margin-top:6px;line-height:1.5}

    /* File upload */
    .file-upload-area{border:2px dashed #cbd5e1;border-radius:12px;padding:24px;text-align:center;background:#f8fafc;transition:all 0.2s ease;cursor:pointer;margin-top:8px}
    .file-upload-area:hover,.file-upload-area.dragover{border-color:#0f6ab8;background:#f0f7ff}
    .upload-content p{margin:8px 0 4px;color:#475569}
    .upload-content p:first-of-type{font-weight:600;color:#334155}
    .file-list{margin-top:16px;text-align:left}
    .file-item{display:flex;align-items:center;gap:12px;padding:8px 12px;background:#fff;border:1px solid #e2e8f0;border-radius:8px;margin-bottom:8px}
    .file-item button{background:#ef4444;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer}

    /* Tooltips */
    .tooltip{position:relative;display:inline-block}
    .tooltip .tooltiptext{visibility:hidden;width:200px;background:#1f2937;color:#fff;text-align:center;border-radius:8px;padding:8px 12px;position:absolute;z-index:1000;bottom:125%;left:50%;margin-left:-100px;opacity:0;transition:opacity 0.3s;font-size:13px;line-height:1.4}
    .tooltip .tooltiptext::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#1f2937 transparent transparent transparent}
    .tooltip:hover .tooltiptext{visibility:visible;opacity:1}

    .actions{display:flex;gap:16px;align-items:center;margin-top:28px;flex-wrap:wrap}
    .btn{appearance:none;border:0;border-radius:12px;padding:16px 28px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:8px;transition:all 0.2s ease;box-shadow:0 2px 8px rgba(0,0,0,.1);font-size:15px;font-family:inherit}
    .btn-primary{background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff;position:relative;overflow:hidden}
    .btn-primary:hover{background:linear-gradient(135deg,#1d4ed8,#1e40af);transform:translateY(-2px);box-shadow:0 4px 16px rgba(37,99,235,.3)}
    .btn-primary:active{transform:translateY(0)}
    .btn-primary:disabled,.btn-primary[aria-busy="true"]{opacity:0.7;cursor:not-allowed;transform:none}
    .btn-primary[aria-busy="true"]:after{content:"";position:absolute;top:50%;left:50%;width:16px;height:16px;margin:-8px 0 0 -8px;border:2px solid transparent;border-top:2px solid #fff;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}

    /* Checkboxes */
    .check-wrap{border:2px solid #e2e8f0;border-radius:12px;padding:16px 18px;margin-top:16px;background:#fff;display:flex;align-items:flex-start;gap:14px;box-shadow:0 2px 8px rgba(0,0,0,.06);transition:all 0.2s ease}
    .check-wrap:hover{border-color:#cbd5e1;box-shadow:0 4px 12px rgba(0,0,0,.08)}
    .check-wrap:has(input:checked){border-color:#0f6ab8;background:rgba(15,106,184,.02)}
    .check-wrap input[type=checkbox]{margin-top:2px;width:20px;height:20px;accent-color:#0f6ab8;cursor:pointer;transition:transform 0.1s ease}
    .check-wrap input[type=checkbox]:hover{transform:scale(1.1)}
    .check-wrap input[type=checkbox]:focus{outline:2px solid #0f6ab8;outline-offset:2px}
    .check-wrap label{font-weight:500;margin:0;line-height:1.5;cursor:pointer}
    .check-wrap span{font-size:13px;color:#334155}

    /* Error states */
    .error-message{color:#dc2626;font-size:13px;margin-top:4px;display:none}
    .field-error .error-message{display:block}
    .field-error input,.field-error select,.field-error textarea{border-color:#dc2626}

    /* Success states */
    .field-success input,.field-success select,.field-success textarea{border-color:#10b981}

    /* Utility: hide any global floating widgets on this page */
    .floating-cta,.floating-cta-container,#floatingCta,.float-cta,.sticky-cta,#ox-chatbase-toggle,#ox-chatbase-container{display:none!important;visibility:hidden!important;pointer-events:none!important}

    footer{max-width:1100px;margin:40px auto 40px;padding:0 20px;color:#5b6f80;font-size:13px;text-align:center}
  </style>

  <!-- Cookie Consent (zonder chat‑enable logic) -->
  <style>
    :root{--line:#0a2b45}
    body.ox-lock{overflow:hidden!important}
    .ox-cc-backdrop{position:fixed;inset:0;background:rgba(2,10,20,.65);backdrop-filter:saturate(120%) blur(2px);z-index:9998}
    .ox-cc-panel{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(92vw,980px);border-radius:16px;border:1px solid var(--line);overflow:hidden;z-index:9999;box-shadow:0 24px 60px rgba(0,0,0,.25)}
    .ox-cc-head{background:linear-gradient(180deg,#083A5C,#002B45);color:#fff;padding:18px 22px;border-bottom:3px solid #29ABE2}
    .ox-cc-body{background:#fff;padding:20px 22px}
    .ox-cc-grid{display:flex;gap:16px;flex-wrap:wrap;align-items:center}
    .ox-cc-text{flex:1;line-height:1.6;color:#0f172a}
    .ox-cc-actions{display:flex;gap:10px;flex-wrap:wrap}
    .ox-btn{appearance:none;border:none;border-radius:10px;cursor:pointer;font-weight:700;font-size:14px;padding:12px 18px}
    .ox-btn.settings{background:#29ABE2;color:#fff}
    .ox-btn.accept{background:#10b981;color:#fff}
    .ox-modal{position:fixed;inset:0;display:none;z-index:10000;align-items:center;justify-content:center;padding:20px;background:rgba(2,10,20,.55)}
    .ox-modal[aria-hidden="false"]{display:flex}
    .ox-modal-card{width:min(92vw,720px);background:#fff;border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 20px 50px rgba(0,0,0,.25)}
    .ox-modal-hd{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid #e5e7eb}
    .ox-modal-bd{padding:16px 18px}
    .ox-modal-ft{display:flex;gap:10px;justify-content:flex-end;padding:14px 18px;border-top:1px solid #e5e7eb}
    .ox-opt{display:flex;gap:12px;border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin:8px 0}
    .ox-switch{position:relative;width:44px;height:24px;flex:0 0 44px}
    .ox-switch input{opacity:0;width:0;height:0}
    .ox-slider{position:absolute;inset:0;background:#e5e7eb;border-radius:999px;transition:.2s}
    .ox-slider:before{content:"";position:absolute;height:18px;width:18px;left:3px;top:3px;background:#fff;border-radius:50%;box-shadow:0 1px 2px rgba(0,0,0,.2);transition:.2s}
    .ox-switch input:checked + .ox-slider{background:#0f6ab8}
    .ox-switch input:checked + .ox-slider:before{transform:translateX(20px)}
    .ox-btn.ghost{background:#fff;border:1px solid #e5e7eb;color:#0f172a}
    @media(max-width:720px){.ox-cc-grid{flex-direction:column;align-items:flex-start}.ox-cc-actions{width:100%;justify-content:flex-end}.ox-cc-actions .ox-btn{flex:1}}
  </style>
</head>
<body>

  <!-- Subhero (zoals contact) -->
  <header class="subhero" role="banner">
    <div class="inner wrap">
      <h1>Offerte aanvragen</h1>
      <p class="subtitle">Snel en transparant — antwoord binnen 24 uur</p>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <h2>Uw gegevens</h2>
      <div class="content">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <form id="offerteForm" action="https://formspree.io/f/xvgbjdav" method="post" novalidate>
          <div class="row">
            <div>
              <label for="naam">Naam <span class="req">*</span></label>
              <input id="naam" name="naam" type="text" autocomplete="name" required placeholder="Voor- en achternaam"/>
              <div class="error-message">Vul uw naam in</div>
            </div>
            <div>
              <label for="email">E‑mail <span class="req">*</span></label>
              <input id="email" name="email" type="email" inputmode="email" autocomplete="email" required placeholder="naam@voorbeeld.be"/>
              <div class="error-message">Vul een geldig e-mailadres in</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="tel">Telefoon <span class="req">*</span> 
                <span class="tooltip">ℹ️
                  <span class="tooltiptext">Handig voor snelle updates over uw offerte en planning van werkzaamheden</span>
                </span>
              </label>
              <input id="tel" name="telefoon" type="tel" inputmode="tel" placeholder="0123 45 67 89" autocomplete="tel" pattern="^[0-9+() -]{6,}$" required/>
              <div class="error-message">Vul een geldig telefoonnummer in</div>
            </div>
            <div>
              <label for="klant">Particulier of zakelijk <span class="req">*</span></label>
              <select id="klant" name="klanttype" required>
                <option value="">Maak een keuze…</option>
                <option value="b2c">Particulier</option>
                <option value="b2b">Zakelijk (bedrijf / zelfstandige)</option>
              </select>
              <div class="error-message">Selecteer uw klanttype</div>
            </div>
          </div>

          <div id="b2b-block" class="hidden">
            <div class="row">
              <div>
                <label for="bedrijfsnaam">Bedrijfsnaam <span class="req">*</span></label>
                <input id="bedrijfsnaam" name="bedrijfsnaam" type="text" autocomplete="organization" placeholder="Naam van uw bedrijf"/>
                <div class="error-message">Vul uw bedrijfsnaam in</div>
              </div>
              <div>
                <label for="btw">BTW‑nummer</label>
                <input id="btw" name="btw" type="text" placeholder="BE0123456789"/>
                <p class="muted">Voor Belgische nummers: BE + 10 cijfers. Buitenlands formaat is ook oké.</p>
              </div>
            </div>
          </div>

          <label for="adres">Adres (straat + nr, gemeente) <span class="req">*</span></label>
          <input id="adres" name="adres" type="text" autocomplete="street-address" required placeholder="Hoofdstraat 123, 9600 Ronse"/>
          <div class="error-message">Vul uw adres in</div>

          <div class="row">
            <div>
              <label for="dienst">Welke dienst? <span class="req">*</span></label>
              <select id="dienst" name="dienst" required>
                <option value="">Maak een keuze…</option>
                <option>Ramenreiniging</option>
                <option>Zonnepanelen</option>
                <option>Ramenreiniging + zonnepanelen (bundel)</option>
              </select>
              <div class="error-message">Selecteer een dienst</div>
            </div>

            <div id="woning-wrap">
              <label for="woning">Type woning <span class="req">*</span></label>
              <select id="woning" name="woningtype">
                <option value="">Maak een keuze…</option>
                <option>Rijwoning (2 gevels)</option>
                <option>Halfopen bebouwing (3 gevels)</option>
                <option>Vrijstaande woning (4 gevels)</option>
                <option>Villa / groot glas</option>
              </select>
              <div class="error-message">Selecteer uw woningtype</div>
            </div>

            <div id="gebouw-wrap" class="hidden">
              <label for="gebouw">Type gebouw <span class="req">*</span></label>
              <select id="gebouw" name="gebouwtype">
                <option value="">Maak een keuze…</option>
                <option>Kantoor</option>
                <option>Winkelruimte</option>
                <option>Showroom</option>
                <option>Horeca</option>
                <option>Praktijkruimte</option>
                <option>Magazijn</option>
                <option>Productiehal</option>
                <option>School / kinderopvang</option>
                <option>Zorginstelling</option>
                <option>Glasgevel (hoog)</option>
                <option>Anders</option>
              </select>
              <p class="muted">Tip: vermeld etages, hoogte van glasgevels en bereikbaarheid in "Opmerkingen".</p>
              <div class="error-message">Selecteer uw gebouwtype</div>
            </div>
          </div>

          <label for="extras">Extra's 
            <span class="tooltip">ℹ️
              <span class="tooltiptext">Heeft u extra glasoppervlakken die gereinigd moeten worden?</span>
            </span>
          </label>
          <select id="extras" name="extras">
            <option value="">Geen extra's</option>
            <option>Veranda</option>
            <option>Glasgevel</option>
            <option>Garage(s)</option>
            <option>Rolluiken</option>
          </select>

          <label for="plan">Onderhoudsplan 
            <span class="tooltip">💰
              <span class="tooltiptext">Bespaar tot 15% met een onderhoudsabonnement! Regelmatig onderhoud houdt uw ramen en panelen in topconditie.</span>
            </span>
          </label>
          <select id="plan" name="onderhoudsplan">
            <option>Geen plan</option>
            <option>Bronze (2x/jaar = 5% korting)</option>
            <option>Silver (4x/jaar = 10% korting)</option>
            <option>Gold (6x/jaar = 15% korting)</option>
          </select>

          <label for="opm">Opmerkingen</label>
          <textarea id="opm" name="opmerkingen" rows="4" placeholder="Handig: aantal verdiepingen, bereikbaarheid, specifieke wensen, beste tijdstip voor contact…"></textarea>
          
          <label for="photos">Foto's uploaden (optioneel) 
            <span class="tooltip">📸
              <span class="tooltiptext">Foto's van uw ramen, zonnepanelen of specifieke situaties helpen ons een nauwkeurigere offerte te maken</span>
            </span>
          </label>
          <div class="file-upload-area" id="fileUploadArea">
            <input type="file" id="photos" name="photos" multiple accept="image/*" style="display:none">
            <div class="upload-content">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="1.5">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <polyline points="21,15 16,10 5,21"/>
              </svg>
              <p><strong>Klik om foto's te selecteren</strong> of sleep ze hierheen</p>
              <p class="muted">Foto's van ramen, zonnepanelen of specifieke situaties helpen ons een betere offerte te maken</p>
            </div>
            <div class="file-list" id="fileList"></div>
          </div>

          <!-- Akkoorden -->
          <div class="check-wrap">
            <input id="privacy" name="privacy" type="checkbox" required/>
            <label for="privacy">Ik ga akkoord met de <a href="privacy.html" target="_blank" rel="noopener">privacyvoorwaarden</a> en dat OsmoseXpert contact opneemt over mijn aanvraag.</label>
          </div>
          <div class="check-wrap">
            <input id="voorwaarden" name="voorwaarden" type="checkbox" required/>
            <label for="voorwaarden">Ik ga akkoord met de <a href="voorwaarden.html" target="_blank" rel="noopener">algemene voorwaarden</a>.</label>
          </div>

          <div class="actions">
            <button class="btn btn-primary" type="submit">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m22 2-7 20-4-9-9-4 20-7z"/>
              </svg>
              Verstuur offerte‑aanvraag
            </button>
          </div>
          <p class="muted" style="margin-top:12px">✅ Tevredenheidsgarantie: niet tevreden? Wij komen terug.</p>
        </form>
      </div>
    </section>
  </main>

  <footer>
    <p>© <span id="y"></span> OsmoseXpert — Ronse &amp; omgeving • <a href="/faq.html">FAQ</a></p>
  </footer>

  <!-- Cookie Consent markup (zonder chat) -->
  <div id="ox-cc-root" hidden>
    <div class="ox-cc-backdrop" aria-hidden="false"></div>
    <section class="ox-cc-panel" role="dialog" aria-modal="true" aria-label="Cookiekeuze">
      <header class="ox-cc-head"><h2>Cookies bij OsmoseXpert</h2></header>
      <div class="ox-cc-body">
        <div class="ox-cc-grid">
          <p class="ox-cc-text">
            We gebruiken cookies om uw ervaring te verbeteren en onze prestaties te meten. U kunt <strong>instellingen aanpassen</strong> of <strong>alle cookies accepteren</strong>.
            Lees ons <a href="/cookiebeleid.html" target="_blank" rel="noopener">cookiebeleid</a> voor details.
          </p>
          <div class="ox-cc-actions">
            <button class="ox-btn settings" type="button" id="ox-btn-settings">Instellingen aanpassen</button>
            <button class="ox-btn accept" type="button" id="ox-btn-accept">Alles accepteren</button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div class="ox-modal" id="ox-settings-modal" aria-hidden="true" aria-label="Cookie‑instellingen">
    <div class="ox-modal-card" role="document">
      <div class="ox-modal-hd"><h3>Cookie‑instellingen</h3><button class="ox-btn ghost" id="ox-btn-close" aria-label="Sluiten">Sluiten</button></div>
      <div class="ox-modal-bd">
        <div class="ox-opt">
          <div class="ox-switch" aria-hidden="true">
            <input type="checkbox" checked disabled>
            <span class="ox-slider"></span>
          </div>
          <div>
            <h4>Essentiële cookies <small>(altijd aan)</small></h4>
            <p>Nodig voor beveiliging, navigatie en basisfunctionaliteit.</p>
          </div>
        </div>
        <div class="ox-opt">
          <label class="ox-switch" for="ox-tog-analytics">
            <input type="checkbox" id="ox-tog-analytics">
            <span class="ox-slider"></span>
          </label>
          <div>
            <h4>Analytische cookies</h4>
            <p>Helpen ons gebruik en prestaties te meten (bijv. GA4).</p>
          </div>
        </div>
        <div class="ox-opt">
          <label class="ox-switch" for="ox-tog-marketing">
            <input type="checkbox" id="ox-tog-marketing">
            <span class="ox-slider"></span>
          </label>
          <div>
            <h4>Marketingcookies</h4>
            <p>Voor widgets/pixels en relevante content.</p>
          </div>
        </div>
      </div>
      <div class="ox-modal-ft">
        <button class="ox-btn ghost" id="ox-btn-cancel">Annuleren</button>
        <button class="ox-btn accept" id="ox-btn-save">Bewaren</button>
      </div>
    </div>
  </div>

  <script>
    // Jaar in footer
    document.getElementById('y').textContent = new Date().getFullYear();

    // Progress tracking
    function updateProgress() {
      const form = document.getElementById('offerteForm');
      const requiredFields = form.querySelectorAll('[required]');
      const filledFields = Array.from(requiredFields).filter(field => {
        if (field.type === 'checkbox') return field.checked;
        return field.value.trim() !== '';
      });
      
      const progress = (filledFields.length / requiredFields.length) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    // File upload functionality
    const fileUploadArea = document.getElementById('fileUploadArea');
    const fileInput = document.getElementById('photos');
    const fileList = document.getElementById('fileList');
    let uploadedFiles = [];

    fileUploadArea.addEventListener('click', () => fileInput.click());
    
    fileUploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      fileUploadArea.classList.add('dragover');
    });
    
    fileUploadArea.addEventListener('dragleave', () => {
      fileUploadArea.classList.remove('dragover');
    });
    
    fileUploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      fileUploadArea.classList.remove('dragover');
      handleFiles(e.dataTransfer.files);
    });
    
    fileInput.addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });

    function handleFiles(files) {
      Array.from(files).forEach(file => {
        if (file.type.startsWith('image/') && file.size < 5 * 1024 * 1024) { // 5MB limit
          uploadedFiles.push(file);
          displayFile(file);
        }
      });
    }

    function displayFile(file) {
      const fileItem = document.createElement('div');
      fileItem.className = 'file-item';
      fileItem.innerHTML = `
        <span>📷 ${file.name} (${(file.size / 1024).toFixed(1)} KB)</span>
        <button type="button" onclick="removeFile('${file.name}')">Verwijder</button>
      `;
      fileList.appendChild(fileItem);
    }

    function removeFile(fileName) {
      uploadedFiles = uploadedFiles.filter(file => file.name !== fileName);
      const fileItems = fileList.querySelectorAll('.file-item');
      fileItems.forEach(item => {
        if (item.textContent.includes(fileName)) {
          item.remove();
        }
      });
    }

    // Form validation
    function validateField(field) {
      const parent = field.closest('div');
      parent.classList.remove('field-error', 'field-success');
      
      if (field.hasAttribute('required') && !field.value.trim()) {
        parent.classList.add('field-error');
        return false;
      }
      
      if (field.type === 'email' && field.value && !field.value.includes('@')) {
        parent.classList.add('field-error');
        return false;
      }
      
      if (field.type === 'tel' && field.value && field.value.length < 6) {
        parent.classList.add('field-error');
        return false;
      }
      
      if (field.value.trim()) {
        parent.classList.add('field-success');
      }
      
      return true;
    }

    // B2B/B2C toggles
    const klantSel = document.getElementById('klant');
    const b2bBlock = document.getElementById('b2b-block');
    const bedrijfsnaam = document.getElementById('bedrijfsnaam');
    const woningWrap = document.getElementById('woning-wrap');
    const woning = document.getElementById('woning');
    const gebouwWrap = document.getElementById('gebouw-wrap');
    const gebouw = document.getElementById('gebouw');

    function syncMode(){
      const isB2B = klantSel && klantSel.value === 'b2b';
      if(b2bBlock){ b2bBlock.classList.toggle('hidden', !isB2B); }
      if(woningWrap){ woningWrap.classList.toggle('hidden', isB2B); }
      if(gebouwWrap){ gebouwWrap.classList.toggle('hidden', !isB2B); }
      if(bedrijfsnaam){ bedrijfsnaam.required = !!isB2B; }
      if(woning){ woning.required = !isB2B; }
      if(gebouw){ gebouw.required = !!isB2B; }
      updateProgress();
    }
    if(klantSel){ klantSel.addEventListener('change', syncMode); syncMode(); }

    // Add event listeners for progress and validation
    const form = document.getElementById('offerteForm');
    if (form) {
      const inputs = form.querySelectorAll('input, select, textarea');
      inputs.forEach(input => {
        input.addEventListener('input', () => {
          validateField(input);
          updateProgress();
        });
        input.addEventListener('blur', () => validateField(input));
      });
    }

    // Form submit via Formspree + redirect (eist beide akkoorden)
    if(form){
      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        
        // Validate all fields
        let isValid = true;
        const inputs = form.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
          if (!validateField(input)) isValid = false;
        });
        
        if (!isValid) {
          // Scroll to first error
          const firstError = form.querySelector('.field-error');
          if (firstError) firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
          return;
        }
        
        if(!form.reportValidity()) return;
        
        const data = new FormData(form);
        
        // Add uploaded files
        uploadedFiles.forEach((file, index) => {
          data.append(`photo_${index}`, file);
        });
        
        const btn = form.querySelector('button[type="submit"]');
        try{
          if(btn){ btn.disabled = true; btn.setAttribute('aria-busy','true'); }
          const res = await fetch(form.action, { method:'POST', body:data, headers:{'Accept':'application/json'} });
          if(res.ok){ 
            // Show success message before redirect
            btn.innerHTML = '✅ Verzonden! Doorsturen...';
            setTimeout(() => window.location.assign('bedankt.html'), 1500);
          }
          else{ 
            throw new Error('Server error');
          }
        }catch(err){ 
          // Custom error modal instead of alert
          showErrorModal('Er ging iets mis met verzenden. Controleer je verbinding en probeer opnieuw, of mail naar info@osmose-xpert.be');
          if(btn){ btn.disabled=false; btn.removeAttribute('aria-busy'); btn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m22 2-7 20-4-9-9-4 20-7z"/></svg>Verstuur offerte‑aanvraag'; }
        }
      });
    }

    function showErrorModal(message) {
      const modal = document.createElement('div');
      modal.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:10000;padding:20px';
      modal.innerHTML = `
        <div style="background:#fff;border-radius:12px;padding:24px;max-width:400px;text-align:center;box-shadow:0 20px 50px rgba(0,0,0,0.3)">
          <h3 style="color:#dc2626;margin:0 0 16px">Oeps!</h3>
          <p style="margin:0 0 20px;line-height:1.5">${message}</p>
          <button onclick="this.closest('div').remove()" style="background:#0f6ab8;color:#fff;border:none;border-radius:8px;padding:12px 24px;cursor:pointer;font-weight:600">Begrepen</button>
        </div>
      `;
      document.body.appendChild(modal);
      setTimeout(() => modal.remove(), 10000); // Auto-remove after 10s
    }

    // Initial progress update
    updateProgress();

    // Cookie Consent (zonder chat‑enable)
    (function(){
      var KEY='ox_cookie_consent_v1';
      var GA_ID='G-FE95SCP0KD';
      var root=document.getElementById('ox-cc-root');
      var btnAccept=document.getElementById('ox-btn-accept');
      var btnSettings=document.getElementById('ox-btn-settings');
      var modal=document.getElementById('ox-settings-modal');
      var btnSave=document.getElementById('ox-btn-save');
      var btnCancel=document.getElementById('ox-btn-cancel');
      var btnClose=document.getElementById('ox-btn-close');
      var togA=document.getElementById('ox-tog-analytics');
      var togM=document.getElementById('ox-tog-marketing');

      function loadState(){ try{return JSON.parse(localStorage.getItem(KEY)||'null')}catch(e){return null} }
      function saveState(v){ localStorage.setItem(KEY, JSON.stringify(v)); }
      function show(){ root.hidden=false; document.body.classList.add('ox-lock'); }
      function hide(){ root.hidden=true; document.body.classList.remove('ox-lock'); }
      function openSettings(){ modal.setAttribute('aria-hidden','false'); }
      function closeSettings(){ modal.setAttribute('aria-hidden','true'); }
      function showOverlay(){ root.querySelector('.ox-cc-backdrop').style.display='block'; root.querySelector('.ox-cc-panel').style.display='block'; }
      function hideOverlay(){ root.querySelector('.ox-cc-backdrop').style.display='none'; root.querySelector('.ox-cc-panel').style.display='none'; }
      function apply(cons){ document.documentElement.dataset.ccAnalytics = cons.analytics ? '1' : '0'; document.documentElement.dataset.ccMarketing = cons.marketing ? '1' : '0'; if(cons.analytics) loadGA(); }
      function acceptAll(){ var cons={essential:true,analytics:true,marketing:true,ts:Date.now()}; saveState(cons); apply(cons); hide(); hideOverlay(); }
      if(btnAccept) btnAccept.addEventListener('click', acceptAll);
      if(btnSettings) btnSettings.addEventListener('click', function(){ openSettings(); });
      if(btnCancel) btnCancel.addEventListener('click', function(){ closeSettings(); });
      if(btnClose) btnClose.addEventListener('click', function(){ closeSettings(); });
      if(btnSave) btnSave.addEventListener('click', function(){ var cons={ essential:true, analytics:!!togA.checked, marketing:!!togM.checked, ts:Date.now() }; saveState(cons); apply(cons); hide(); closeSettings(); hideOverlay(); });
      var current=loadState(); if(!current){ show(); showOverlay(); } else { apply(current); }
      function loadGA(){ if(!GA_ID || document.getElementById('ga4-src')) return; var s1=document.createElement('script'); s1.async=true; s1.src='https://www.googletagmanager.com/gtag/js?id='+GA_ID; s1.id='ga4-src'; document.head.appendChild(s1); var s2=document.createElement('script'); s2.id='ga4-init'; s2.text="window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config','"+GA_ID+"',{anonymize_ip:true});"; document.head.appendChild(s2); }
    })();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99607eff675990b8',t:'MTc2MTcxODA4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
